---
import Center from "../components/Center.astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import RagInlineLite from "../components/RagInlineLite.tsx";
---

<BaseLayout
  title="Ren Zhiyan's Profile"
  description="Welcome to my little corner of the internet – playful, curious, and live with love."
  includeFooter
>
  <Center>
    <section class="home">
      <div class="intro">
        <p>
          This is a 
          personal space of growing thoughts and tiny projects. You’re welcome to wander around. 
        </p>
      </div>

      <!-- RAG 聊天：嵌在介绍段落下面，占满宽度 -->
      <div class="rag-full">
        <RagInlineLite client:load />
      </div>
    </section>
  </Center>
</BaseLayout>

<style lang="scss">
  .home {
    display: flex;
    flex-direction: column;
    gap: var(--space-3xl);
    padding-block-end: var(--space-3xl);
  }

  .intro {
    padding-block-start: var(--space-2xl);
    text-wrap: balance;
    user-select: none;

    p {
      font-size: var(--step-4);
      letter-spacing: var(--letter-spacing-condensed);
      line-height: var(--line-height-tight);
    }
  }

  /* 占满可用宽度（受 Center 容器限制） */
  .rag-full { width: 100%; }

  /* ===== 黑白灰微信/Slack 气泡风 ===== */
  .rag-wrap {
    width: 100%;
    border: 1px solid #e9e9e9;
    border-radius: 16px;
    background: #fff;
    box-shadow: 0 6px 24px rgba(0,0,0,.04);
    padding: 16px;
  }
  .rag-header {
    font-size: var(--step-1);
    font-weight: 600;
    color: #111;
    margin-bottom: 12px;
  }
  .rag-box {
    height: min(52vh, 560px);
    overflow: auto;
    background: #fafafa;
    border: 1px solid #eee;
    border-radius: 12px;
    padding: 14px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .bubble-row { display: flex; }
  .bubble-row.user { justify-content: flex-end; }
  .bubble-row.assistant { justify-content: flex-start; }

  .bubble {
    max-width: min(72ch, 90%);
    padding: 10px 12px;
    border-radius: 14px;
    border: 1px solid #e6e6e6;
    background: #fff;
  }
  .bubble-row.user .bubble {
    background: #f0f2f5; border-color: #e1e1e1;
  }
  .bubble-text { white-space: pre-wrap; line-height: 1.6; color: #111; }

  .typing { font-size: 12px; color: #777; padding: 4px; }

  .sources { margin-top: 8px; }
  .sources-title { font-size: 12px; color: #777; margin-bottom: 6px; }
  .chips { display: flex; flex-wrap: wrap; gap: 6px; }
  .chip {
    display: inline-flex; align-items: center;
    max-width: 220px;
    padding: 4px 8px; border-radius: 10px;
    font-size: 12px; color: #0b57d0; background: #edf2ff; border: 1px solid #dbe4ff;
    text-decoration: none; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
  }
  .chip.more { color: #0b57d0; background: transparent; border: none; cursor: pointer; }

  .rag-input {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 10px;
    align-items: center;
    margin-top: 12px;
  }
  .rag-input textarea {
    width: 100%;
    min-height: 48px; max-height: 160px; resize: vertical;
    font: inherit; line-height: 1.5;
    padding: 10px 12px; border: 1px solid #e5e5e5; border-radius: 12px;
    background: #fff; color: #111;
  }
  .send-btn {
    padding: 10px 16px;
    border-radius: 12px;
    border: 1px solid #e5e5e5;
    background: #111; color: #fff; font-weight: 600; cursor: pointer;
  }
  .send-btn:disabled { opacity: .6; cursor: not-allowed; }
</style>
